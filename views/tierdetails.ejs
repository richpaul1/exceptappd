<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="/css/spinner.css" type="text/css">
<style>

table {
	font-family:Arial, Helvetica, sans-serif;
	font-size:12px;
	margin:10px;
	border:black 1px solid;
}
table th {
}
table th:first-child {
	text-align: left;
	padding-left:20px;
}
table td {
}
table tr.even td {
}
</style>
<script src= "http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
</head>

<body>
<div>
	<img src="/public/images/<%=appid%>_<%=tierid%>.png"/>
</div>
<div class="datagrid" ng-app="" ng-controller="errorController">
	<table>
		<thead>
			<tr>
		  		<th>Exception</th>
				<th><%=week%> Week Avg</th>
		  		<th><%=lastminutes%> Minute Avg</th>
		  		<th>Difference</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="err in exceptions" ng-class-odd="'alt'">
			    <td><a href="{{err.url}}">{{err.name}}</a></td>
			    <td>{{err.weekavg}}</td>
			    <td>{{err.minavg }}</td>
			    <td>{{err.diff }}</td>
			</tr>
		</tbody>
	</table>
	<div id="spinner" class="throbber">
    	Loading...
	</div>
</div>

<script>
function errorController($scope,$http) {
  $http.get("/exceptionstatsjson/<%=appid%>/<%=tierid%>")
  .success(function(response) {
  		document.getElementById("spinner").style.display = 'none';
  		$scope.exceptions = response;
  	});
}
</script>

</body>
</html>
